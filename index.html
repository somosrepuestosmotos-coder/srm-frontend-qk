<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Presentación interactiva SRM-QK | Somos Repuestos Motos - innovación, crecimiento y estrategia digital." />

  <title>SRM-QK | Somos Repuestos Motos</title>

  <!-- ✅ Favicons -->
  <link rel="icon" type="image/x-icon" href="favicon.ico" />
  <link rel="apple-touch-icon" href="apple-touch-icon.png" />
  <link rel="manifest" href="site.webmanifest" />

  <!-- ✅ OpenGraph -->
  <meta property="og:title" content="SRM-QK | Somos Repuestos Motos" />
  <meta property="og:description" content="Explora la presentación digital de SRM-QK: visión, estrategia y crecimiento." />
  <meta property="og:image" content="https://somosrepuestosmotos-coder.github.io/srm-frontend-qk/og-image-srmqk.png" />
  <meta property="og:url" content="https://somosrepuestosmotos-coder.github.io/srm-frontend-qk/" />
  <meta property="og:type" content="website" />

  <!-- ✅ Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="SRM-QK | Somos Repuestos Motos" />
  <meta name="twitter:description" content="Explora la presentación digital de SRM-QK: visión, estrategia y crecimiento." />
  <meta name="twitter:image" content="https://somosrepuestosmotos-coder.github.io/srm-frontend-qk/og-image-srmqk.png" />

  <style>
    body {
      margin: 0;
      background-color: #000;
      color: #fff;
      font-family: "Poppins", sans-serif;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      flex-direction: column;
    }

    video {
      width: 100%;
      height: 100vh;
      object-fit: cover;
      display: none;
    }

    #questionnaire {
      display: none;
      padding: 20px;
      text-align: center;
      background: rgba(0, 0, 0, 0.85);
      border-radius: 10px;
      max-width: 90%;
    }

    button {
      margin: 10px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background-color: #ff6600;
      color: #fff;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.3s;
    }

    button:hover {
      background-color: #ff8533;
    }

    #startBtn {
      position: absolute;
      z-index: 10;
      padding: 14px 28px;
      background: #ff6600;
      border: none;
      border-radius: 12px;
      color: white;
      font-size: 1.1em;
      cursor: pointer;
    }
  </style>
</head>

<body>
  <button id="startBtn">Comenzar presentación</button>
  <video id="videoPlayer" playsinline></video>

  <div id="questionnaire">
    <h2>Queremos conocerte mejor</h2>

    <div class="question" data-question="main_objective_6m">
      <p>¿Cuál es tu principal objetivo en los próximos 6 meses?</p>
      <button>Aumentar ventas B2B</button>
      <button>Expandir a nuevos regiones</button>
      <button>Mejorar la rentabilidad</button>
    </div>

    <div class="question" data-question="biggest_challenge">
      <p>¿Cuál es tu mayor desafío actual?</p>
      <button>Logística y entregas</button>
      <button>Fidelización de clientes</button>
      <button>Digitalización de procesos</button>
    </div>

    <div class="question" data-question="investment_priority">
      <p>¿Dónde planeas invertir más próximamente?</p>
      <button>Capacitación de equipo</button>
      <button>Marketing y Publicidad</button>
      <button>Tecnología (E-commerce, CRM)</button>
    </div>

    <div class="question" data-question="start_timeline">
      <p>¿Cuándo deseas iniciar estas mejoras?</p>
      <button>Inmediatamente</button>
      <button>En el próximo trimestre</button>
      <button>Aún por definir</button>
    </div>
  </div>

  <script>
    const backendURL = "https://srm-backend-qk-lwid.onrender.com/api/responder";

    document.addEventListener("DOMContentLoaded", () => {
      const startBtn = document.getElementById("startBtn");
      const videoPlayer = document.getElementById("videoPlayer");
      const questionnaire = document.getElementById("questionnaire");

      const videos = [
        "https://srm-backend-qk-lwid.onrender.com/videos/animacion-logo-qk-original.mp4",
        "https://srm-backend-qk-lwid.onrender.com/videos/animacion-nuevo-logo-3d.mp4",
        "https://srm-backend-qk-lwid.onrender.com/videos/animacion-srm-qk-k.mp4",
        "https://srm-backend-qk-lwid.onrender.com/videos/animacion-papeleria-merchandising-packaging.mp4",
        "https://srm-backend-qk-lwid.onrender.com/videos/animacion-insight-mercado.mp4",
        "https://srm-backend-qk-lwid.onrender.com/videos/animacion-ecosistema-digital.mp4"
      ];

      let currentVideo = 0;
      const sessionId = "session_" + Date.now() + "_" + Math.random().toString(36).substring(2, 10);

      const playVideo = (index) => {
        if (index >= videos.length) {
          videoPlayer.style.display = "none";
          questionnaire.style.display = "block";
          document.querySelector(".question").style.display = "block";
          return;
        }
        videoPlayer.src = videos[index];
        videoPlayer.load();
        videoPlayer.play().catch(() => {});
        console.log("▶️ Reproduciendo video:", index + 1);
      };

      videoPlayer.addEventListener("ended", () => {
        currentVideo++;
        playVideo(currentVideo);
      });

      startBtn.addEventListener("click", () => {
        startBtn.style.display = "none";
        videoPlayer.style.display = "block";
        currentVideo = 0;
        playVideo(currentVideo);
      });

      document.querySelectorAll(".question button").forEach((btn) => {
        btn.addEventListener("click", async (e) => {
          const questionDiv = e.target.closest(".question");
          const questionKey = questionDiv.dataset.question;
          const answer = e.target.textContent.trim();

          const payload = {
            session_id: sessionId,
            pregunta: questionKey,
            respuesta: answer
          };

          try {
            const res = await fetch(backendURL, {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify(payload)
            });

            if (res.ok) {
              console.log(`✅ Guardado: ${questionKey} → ${answer}`);
              questionDiv.style.display = "none";
              const next = questionDiv.nextElementSibling;
              if (next) next.style.display = "block";
              else questionDiv.innerHTML = "<h3>¡Gracias por participar!</h3>";
            } else {
              console.warn(`⚠️ Error al guardar ${questionKey}`);
            }
          } catch (err) {
            console.error("Error de red:", err);
          }
        });
      });
    });
  </script>
</body>
</html>
